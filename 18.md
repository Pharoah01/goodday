1:

ENCRYPT AND DECRYPT MESSAGE USING PGP KEYS
Aim:
To encrypt and decrypt messages or files using PGP keys and GPG commands in Linux, ensuring secure data confidentiality and integrity through public key cryptography.
Procedure:
Step 1: GPG version
Check if GNU Privacy Guard (GPG) is already in your system.
$ gpg --version

Step 1(a): Install GPG (if not already installed)
$ sudo apt install gnupg

Step 2: Generate Key Pair
$ gpg --gen-key

Step 2(a): Construct a User ID
Follow prompts to enter:
Real Name: Test user (anything you wish) Email address: test@example.com

Step 2(b): Enter a Passphrase and confirm


Step 3: Ensure if the keys are created and signed
$ gpg --list-keys

Step 4: Create a message.txt for PGP
$ nano message.txt


Step 4(a): Content on message.txt
Write your message & (i)Press Ctrl+X 
(ii)Press y and 
(iii)Enter to save and exit the message.txt


Step 5: Encrypt a file
$ gpg -e -r �Test User� message.txt

This command creates message.txt.gpg which contains the encrypted version of message.txt
Step 5(a): Ensure message.txt.gpg is created
$ ls -l

$ cat m
message.txt.gpg


Its shows the content present in message.txt.gpg which is in the form of Binary encrypted data, not human-readable plaintext

Step 6: Decrypt the file
$ gpg -d message.txt.gpg

Step 6(a): Enter your Passphrase
On Prompt: Enter your Passphrase to decrypt the message


RESULT: Thus the encryption and decryption of messages using PGP keys was successfully completed.

sub-ques:
(a) Public key encrypts; private key decrypts.
(b) gpg --gen-key

2:

Source Code:

from Crypto.Cipher import Blowfish
from Crypto.Random import get_random_bytes
from struct import pack

BLOCK_SIZE = Blowfish.block_size # Block size for Blowfish (8 bytes)

def pad(text):
  """Pads the input text to ensure it's a multiple of 8 bytes."""
  plen = BLOCK_SIZE - len(text) % BLOCK_SIZE
  padding = [plen]*plen
  padding = pack('b'*plen, *padding)
  return text + padding

def unpad(text):
  """Removes the padding from the decrypted text."""
  plen = text[-1]
  return text[:-plen]
 
def generate_key():
  """Generates a random Blowfish key (4 to 56 bytes)."""
  return get_random_bytes(16) # Example: Generate a 16-byte key
 
def encrypt(plain_text, key):
  """Encrypts the plaintext using Blowfish encryption."""
  cipher = Blowfish.new(key, Blowfish.MODE_ECB)
  padded_text = pad(plain_text.encode('utf-8'))
  encrypted_text = cipher.encrypt(padded_text)
  return encrypted_text

def main():
    plain_text = input("Enter the text to encrypt: ")
    key = generate_key()
    print(f"Generated Key (hex): {key.hex()}")

    encrypted_text = encrypt(plain_text, key)
    print(f"Encrypted Text (hex): {encrypted_text.hex()}")

if __name__ == "__main__":
    main()

sub-ques:
(a) The block size of Blowfish is 64 bits (8 bytes).
(b) Blowfish handles key expansion by converting the variable-length key (32–448 bits) into several subkeys and S-boxes, which are then used in each of the 16 encryption rounds. This process ensures strong diffusion and security.