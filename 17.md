1: 
AIM:
To configure a Linux server to allow only key-based SSH authentication and to secure it using Fail2Ban to prevent brute-force attacks.

PROCEDURE:
Step 1: Update the System
$ sudo apt update && sudo apt upgrade -y
Ensures all packages are updated for stability and security.

STEP 2: Install/OpenSSH Server (if not installed)
$ sudo apt install openssh-server -y

Installs the SSH server required for remote login.

Start SSH on server:
$ sudo systemctl start ssh
$ sudo systemctl enable ssh


Step 3: Generate SSH Key Pair (on client machine)
$ ssh-keygen -t rsa -b 4096

Creates a public-private key pair for secure SSH login.
Generates a strong public-private key pair for secure authentication.
Press Enter to accept the default location (~/.ssh/id_rsa).
For no passphrase, press Enter. Otherwise, enter your desired passphrase. 

Step 4: Copy public key to server

$ ssh-copy-id username@server_ip
Copies your public key to serverï¿½s authorized keys.
Replace:
username ? your actual username (e.g., kali, ubuntu)
server_ip ? actual IP (e.g., 192.168.1.10)
To find your server ip

$ ip a

STEP 5: Disable Password Login on Server

$ sudo nano /etc/ssh/sshd_config

Find and change or add:
PasswordAuthentication no
PermitRootLogin no
PubkeyAuthentication yes

Press Ctrl + O -> Enter  ? Ctrl + X

Restart SSH:

$ sudo systemctl restart ssh
Applies the new SSH configuration settings

STEP 6: Test Key-Based Login

$ ssh username@server_ip
If it logs in without a password, you're good.


STEP 7: Install Fail2Ban

$ sudo apt install fail2ban -y
Installs Fail2Ban, a security tool that blocks brute-force attacks.

STEP 8: Configure Fail2Ban

$ sudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local
$ sudo nano /etc/fail2ban/jail.local


Scroll through the file and check:
Delete the existing [DEFAULT] and [SSHD] block and replace with this.
Scroll to bottom and paste:
[DEFAULT]
bantime = 600
findtime = 600
maxretry = 3
backend = systemd
[sshd]
enabled = true
port = ssh
logpath = %(sshd_log)s


Press Ctrl + O -> Enter  ? Ctrl + X

STEP 9: Start and Enable Fail2Ban

$ sudo systemctl start fail2ban
$ sudo systemctl enable fail2ban


STEP 10: Check Fail2Ban Status

$sudo systemctl status fail2ban
$sudo fail2ban-client status

Optional check SSH-specific stats:

$sudo fail2ban-client status sshd

Result:
Thus, SSH was secured with key-based authentication and Fail2Ban, ensuring only authorized key access while blocking brute-force attacks.

Sub-Ques:
(a) /etc/fail2ban/jail.conf or /etc/fail2ban/jail.local.
(b) sudo fail2ban-client unban <IP>

2:

Source Code:
from Crypto.Cipher import Blowfish
from Crypto.Random import get_random_bytes
from struct import pack, unpack

BLOCK_SIZE = Blowfish.block_size 

def pad(text):
    plen = BLOCK_SIZE - len(text) % BLOCK_SIZE
    padding = [plen] * plen
    padding = pack('b'*plen, *padding)
    return text + padding

def unpad(text):
    plen = text[-1]
    return text[:-plen]

def generate_key():
    return get_random_bytes(16)  # 16-byte key

def encrypt(plain_text, key):
    cipher = Blowfish.new(key, Blowfish.MODE_ECB)
    padded_text = pad(plain_text.encode('utf-8'))
    encrypted_text = cipher.encrypt(padded_text)
    return encrypted_text

def decrypt(cipher_text, key):
    cipher = Blowfish.new(key, Blowfish.MODE_ECB)
    decrypted_padded_text = cipher.decrypt(cipher_text)
    decrypted_text = unpad(decrypted_padded_text).decode('utf-8')
    return decrypted_text

def main():
    original_text = "Cyber Security"
    key = generate_key()
    print(f"Generated Key (hex): {key.hex()}")

    encrypted_text = encrypt(original_text, key)
    print(f"Encrypted Text (hex): {encrypted_text.hex()}")

    decrypted_text = decrypt(encrypted_text, key)
    print(f"Decrypted Text: {decrypted_text}")

if __name__ == "__main__":
    main()

Sub-ques:
(a) In symmetric cryptography, the encryption key and decryption key are the same. That means the same secret key is used to encrypt and decrypt data, unlike asymmetric cryptography which uses different keys.

(b) In Blowfish, the Feistel structure is used to split the plaintext block into two halves. In each of the 16 rounds:

    One half is processed using a function (F-function) with a subkey.
    The result is XORed with the other half.
    The halves are then swapped.
    This structure ensures diffusion and security, making Blowfish resistant to cryptanalysis.